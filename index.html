<!DOCTYPE html>
<html>
<head>
    <title>Flask App</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            $.get('/get_serial_ports', function(data) {
                data.serial_ports.forEach(function(port) {
                    $('#serial-port-select').append(`<option value="${port}">${port}</option>`);
                });
            });

            $.get('/get_network_interfaces', function(data) {
                data.network_interfaces.forEach(function(interface) {
                    $('#network-interface-select').append(`<option value="${interface}">${interface}</option>`);
                });
            });
        });
    </script>
</head>
<body>
    <h1>Flask App</h1>

    <h2>Serial Ports</h2>
    <select id="serial-port-select">
        <option selected>Select a Serial Port</option>
    </select>

    <h2>Network Interfaces</h2>
    <select id="network-interface-select">
        <option selected>Select a Network Interface</option>
    </select>

    <h2>WiFi Scan</h2>
    <button id="start-wifi-scan">Start WiFi Scan</button>

    <h2>WiFi Devices</h2>
    <table id="wifi-devices-table">
        <thead>
            <tr>
                <th>MAC</th>
                <th>SSID</th>
                <th>ESSID</th>
                <th>Device Type</th>
                <th>Track</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <script>
        $('#start-wifi-scan').click(function() {
            const interface = $('#network-interface-select').val();

            $.post('/wifi_scan', { interface: interface }, function(data) {
                const tbody = $('#wifi-devices-table tbody');
                tbody.empty();

                data.devices.forEach(function(device) {
                    tbody.append(`
                        <tr>
                            <td>${device.mac}</td>
                            <td>${device.ssid}</td>
                            <td>${device.essid}</td>
                            <td>${device.device_type}</td>
                            <td><button class="track-button">Track</button></td>
                        </tr>
                    `);
                });
            });
        });

        $(document).on('click', '.track-button', function() {
            const row = $(this).parent().parent();
            const mac = row.find('td:nth-child(1)').text();
            console.log(`Track button clicked for device with MAC address: ${mac}`);
        });
    </script>
</body>
</html>
